//! Data definitions for ITS payload words
pub mod data_words;
pub mod status_words;

// Utility functions to extract information from the FeeId
/// Extracts stave_number from 6 LSB \[5:0\]
pub fn stave_number_from_feeid(fee_id: u16) -> u8 {
    let stave_number_mask: u16 = 0b11_1111;
    (fee_id & stave_number_mask) as u8
}
/// Extracts layer number from 3 bits \[14:12\]
pub fn layer_from_feeid(fee_id: u16) -> u8 {
    // Extract layer from 3 bits 14:12
    let layer_mask: u16 = 0b0111;
    let layer_lsb_idx: u8 = 12;
    ((fee_id >> layer_lsb_idx) & layer_mask) as u8
}

/// Payload test values for ITS
pub mod test_payloads {
    /// The beginning of a payload in flavor 0
    pub const START_PAYLOAD_FLAVOR_0: [u8; 32] = [
        0xC0, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x03, 0x1a, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0xE8, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00,
    ];
    /// The beginning of a payload in flavor 2
    pub const START_PAYLOAD_FLAVOR_2: [u8; 20] = [
        0x38, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe0, 0x13, 0x08, 0x00, 0x00, 0x00,
        0xD7, 0x39, 0x9B, 0x00, 0xE8,
    ];

    /// Middle of a payload in flavor 0, just one Data Word with padding
    pub const MIDDLE_PAYLOAD_FLAVOR_0: [u8; 16] = [
        0xA7, 0x00, 0xC0, 0x41, 0xFF, 0xB0, 0x00, 0x00, 0x00, 0x27, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
    ];

    /// Middle of a payload in flavor 2, two packed Data Words
    pub const MIDDLE_PAYLOAD_FLAVOR_2: [u8; 20] = [
        0xA7, 0x00, 0xC0, 0x41, 0xFF, 0xB0, 0x00, 0x00, 0x00, 0x27, 0xA8, 0x00, 0xC0, 0x41, 0xFF,
        0xB0, 0x00, 0x00, 0x00, 0x28,
    ];

    /// End of a payload in flavor 0: has no 0xFF padding, this is just a TDT followed by the 0x00 padding
    pub const END_PAYLOAD_FLAVOR_0: [u8; 16] = [
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00,
    ];
    /// End of a payload in flavor 2: TDT and 0xFF padding
    pub const END_PAYLOAD_FLAVOR_2: [u8; 16] = [
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xF0, 0xff, 0xff, 0xff, 0xff, 0xff,
        0xff,
    ];
}
